

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Encrypted Forms &mdash; Open Data Kit Docs</title>
  

  
  
    <link rel="shortcut icon" href="_static/odk-favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="Open Data Kit Docs" href="index.html"/>
        <link rel="next" title="Security and Privacy" href="security-privacy.html"/>
        <link rel="prev" title="Briefcase Aggregate API" href="briefcase-api.html"/>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-91951913-4', 'auto');
  ga('send', 'pageview');

</script>




  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html">
          

          
            
            <img src="_static/odk-logo-wide.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Collect</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="collect-intro.html">ODK Collect</a></li>
<li class="toctree-l1"><a class="reference internal" href="collect-setup.html">Setting Up ODK Collect</a></li>
<li class="toctree-l1"><a class="reference internal" href="collect-using.html">Using ODK Collect</a></li>
<li class="toctree-l1"><a class="reference internal" href="collect-best-practices.html">Tips and Best Practices</a></li>
</ul>
<p class="caption"><span class="caption-text">Aggregate</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="aggregate-guide.html">ODK Aggregate</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate-install.html">Aggregate Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate-deployment-planning.html">Aggregate Deployment Planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate-use.html">Aggregate Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate-upgrade.html">Aggregate Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate-backup.html">Backup Strategies for Aggregate</a></li>
<li class="toctree-l1"><a class="reference internal" href="form-uploader.html">Form Uploader</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth2-service.html">OAuth2 Service Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize.html">Visualizing Geographic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate-limitations.html">Aggregate Limitations</a></li>
</ul>
<p class="caption"><span class="caption-text">Briefcase</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="briefcase-guide.html">ODK Briefcase</a></li>
<li class="toctree-l1"><a class="reference internal" href="briefcase-install.html">Briefcase Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="briefcase-forms.html">Briefcase Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="briefcase-vs-aggregate.html">Briefcase vs Aggregate</a></li>
</ul>
<p class="caption"><span class="caption-text">Form Building</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="form-design-intro.html">Intro to Forms in ODK</a></li>
<li class="toctree-l1"><a class="reference internal" href="odk-build.html">ODK Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="xlsform.html">XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="form-widgets.html">Form Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="form-interaction.html">Interaction of constraints, relevants and read only</a></li>
<li class="toctree-l1"><a class="reference internal" href="form-update.html">Updating forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyxform.html">pyxform</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate.html">ODK Form Validate</a></li>
<li class="toctree-l1"><a class="reference internal" href="launch-apps-from-collect.html">Launching External Apps from Collect Forms</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to ODK Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="cygwin.html">Working with Docs in Windows using Cygwin</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing-tips.html">Tips for Making Good Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="style-guide.html">Style Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Developing with ODK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openrosa.html">OpenRosa</a></li>
<li class="toctree-l1"><a class="reference internal" href="javarosa.html">ODK JavaRosa</a></li>
<li class="toctree-l1"><a class="reference internal" href="launch-collect-from-app.html">Launching ODK Collect from External Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="briefcase-api.html">Briefcase Aggregate API</a></li>
</ul>
<p class="caption"><span class="caption-text">Integration</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Encrypted Forms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#security-concerns">Security Concerns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#windows">Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macos">macOS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#uploading-finalized-forms">Uploading Finalized Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-rsa-key-pair">Creating RSA Key pair</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#install-openssl-windows-only">Install OpenSSL (Windows only)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-the-rsa-key-pair">Constructing the RSA Key Pair</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-a-private-key">Create a private key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extract-a-public-key">Extract a public key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#storing-and-using-the-keys">Storing and using the keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-the-public-key-field-in-the-xlsform-settings-worksheet">Updating the public_key field in the XLSForm settings worksheet.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#operations">Operations</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="security-privacy.html">Security and Privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="verify-downloads.html">Verifying Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Open Data Kit</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Encrypted Forms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/encrypted-forms.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="encrypted-forms">
<h1>Encrypted Forms<a class="headerlink" href="#encrypted-forms" title="Link zu dieser Überschrift">¶</a></h1>
<div class="section" id="overview">
<span id="id1"></span><h2>Overview<a class="headerlink" href="#overview" title="Link zu dieser Überschrift">¶</a></h2>
<p>Encrypted forms provide a mechanism to keep your data private even when using <strong>http:</strong> for communications (e.g., when you do not have an <strong>SSL certificate</strong> or <strong>https:</strong> is not available). Encrypted forms may also enable Google App Engine deployments (and deployments using other web database services, e.g., AWS) to comply with data privacy laws, eliminating the necessity for setting up your own servers to meet those requirements.</p>
<p>Encrypted forms apply asymmetric public key encryption at the time the form is finalized within ODK Collect. This encrypted form can then be submitted up to ODK Aggregate and downloaded to ODK Briefcase. ODK Briefcase, when supplied with the asymmetric private key (which ODK Briefcase never stores), can then decrypt and export the form data as a CSV file for your use.</p>
<p>This process ensures that the finalized form’s data (and media attachments) are encrypted before being submitted to ODK Aggregate, remain encrypted while stored on ODK Aggregate, and remain encrypted as the data and attachments are pulled into ODK Briefcase, where they are again stored in encrypted form.</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<ul class="last simple">
<li>ODK Aggregate cannot meaningfully publish encrypted forms to Google Spreadsheets or Fusion Tables since the encryption obscures the entire contents of the form and ODK Aggregate never possesses the asymmetric key required to decrypt the form.</li>
<li>When using encrypted forms, ODK Aggregate serves only as a data aggregation point — you must download, decrypt, and export the data using ODK Briefcase to access the unencrypted data</li>
</ul>
</div>
<p>The non-encrypted data is available on the ODK Collect device during data collection and whenever a form is saved without marking it as complete. Once you mark a form as complete (finalize it), ODK Collect will generate a random 256-bit symmetric key, encrypt the form contents and all attachments with this key, then construct a submission manifest which describes the encrypted submission and an asymmetric-key encryption of the symmetric key used for the encryption. This manifest is the „form“ that is uploaded to ODK Aggregate, with the encrypted form contents and its encrypted attachments appearing as attachments to this submission manifest „form.“</p>
</div>
<div class="section" id="requirements">
<span id="encrypt-requirements"></span><h2>Requirements<a class="headerlink" href="#requirements" title="Link zu dieser Überschrift">¶</a></h2>
<p>Encrypted forms require the following <em>minimum versions</em> of the ODK tools</p>
<ul class="simple">
<li><a class="reference internal" href="collect-install.html"><span class="doc">ODK Collect 1.2 Release Candidate 1 (RC1) or higher</span></a></li>
<li><a class="reference internal" href="aggregate-install.html"><span class="doc">ODK Aggregate 1.0.4 Production or higher</span></a></li>
<li><a class="reference internal" href="briefcase-install.html"><span class="doc">ODK Briefcase 1.0 Production or higher</span></a></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warnung</p>
<p class="last">Encrypted form definitions must include a unique OpenRosa instanceID and have an explicit <code class="docutils literal"><span class="pre">&lt;submission/&gt;</span></code> element</p>
</div>
<p>These requirements are covered in more detail below.</p>
</div>
<div class="section" id="security-concerns">
<span id="id2"></span><h2>Security Concerns<a class="headerlink" href="#security-concerns" title="Link zu dieser Überschrift">¶</a></h2>
<p>While ODK Collect attempts to remove all unencrypted copies of a finalized form and its attachments from the device, because ODK Collect uses third-party applications for image capture, etc., and because of the potential for Forced Close events during the clean-up process, we cannot guarantee that all copies will have been destroyed. Furthermore, because of the way an SD card writes and deletes information, there is a possibility of this data being recoverable from the free space on the SD card. Your organization should investigate the extra steps needed to ensure all data is deleted from the SD cards on your ODK Collect devices and should establish procedures to periodically wipe and reinstall those devices.</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p class="last">Encrypting a form ensures that the finalized form is not readable and is not tampered with. However, there is nothing preventing a malicious adversary from the wholesale replacement of a finalized form with falsified data or the synthesis and submission of extra data — these are not contingencies that encrypted forms seek to address.</p>
</div>
</div>
<div class="section" id="configuration">
<span id="config-briefcase"></span><h2>Configuration<a class="headerlink" href="#configuration" title="Link zu dieser Überschrift">¶</a></h2>
<p>For ODK Briefcase, you must download and install the <em>Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files 6</em> from the <a class="reference external" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html#other">Java download site</a>; for previous versions of Java, it is available <a class="reference external" href="http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html">here</a>. This is required for decryption to be successful.</p>
<p>To install the JCE:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Select the downloaded UCE zip archive file in the file viewer.</li>
<li>Right-click, choose <span class="guilabel">Extract files…</span> and extract the files from the downloaded zip archive.</li>
<li>Navigate into the extracted directory tree and copy the <code class="file docutils literal"><span class="pre">local_policy.jar</span></code> and <code class="file docutils literal"><span class="pre">US_export_policy.jar</span></code> files to the <code class="file docutils literal"><span class="pre">libsecurity</span></code> directory under the installation directory of the Java Runtime Environment (JRE) of your computer, replacing earlier versions of these files.</li>
</ol>
</div></blockquote>
<div class="section" id="windows">
<h3>Windows<a class="headerlink" href="#windows" title="Link zu dieser Überschrift">¶</a></h3>
<p>The JRE is usually installed here:</p>
<p><code class="file docutils literal"><span class="pre">C:\Program</span> <span class="pre">Files\Java\jre1.x.x_xxx\lib\security</span></code></p>
<p>You might also have a JDK. If you do, you must also install the JCE files there:</p>
<p><code class="file docutils literal"><span class="pre">C:\Program</span> <span class="pre">Files\Java\jdk1.x.x_xxx\jre\lib\security</span></code></p>
</div>
<div class="section" id="macos">
<h3>macOS<a class="headerlink" href="#macos" title="Link zu dieser Überschrift">¶</a></h3>
<p>The JRE is usually found here:</p>
<p><code class="file docutils literal"><span class="pre">/Library/Internet</span> <span class="pre">Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/lib/security</span></code></p>
<p>You might also have a JDK. If you do, you must also install the JCE files there:</p>
<p><code class="file docutils literal"><span class="pre">/Library/Java/JavaVirtualMachines/jdk1.x.x_xxx.jdk/Contents/Home/jre/lib/security</span></code></p>
</div>
</div>
<div class="section" id="uploading-finalized-forms">
<span id="upload-final-forms"></span><h2>Uploading Finalized Forms<a class="headerlink" href="#uploading-finalized-forms" title="Link zu dieser Überschrift">¶</a></h2>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;h:html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2002/xforms&quot;</span>
     <span class="na">xmlns:h=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
     <span class="na">xmlns:orx=</span><span class="s">&quot;http://openrosa.org/xforms/&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;h:head&gt;</span>
<span class="nt">&lt;h:title&gt;</span>Sample Form<span class="nt">&lt;/h:title&gt;</span>
<span class="nt">&lt;model&gt;</span>
 <span class="nt">&lt;itext&gt;</span>
   <span class="nt">&lt;translation</span> <span class="na">lang=</span><span class="s">&quot;English&quot;</span> <span class="na">default=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;ask_name&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;value</span> <span class="na">form=</span><span class="s">&quot;long&quot;</span><span class="nt">&gt;</span>Please enter your name:<span class="nt">&lt;/value&gt;</span>
       <span class="nt">&lt;value</span> <span class="na">form=</span><span class="s">&quot;short&quot;</span><span class="nt">&gt;</span>Respondent&#39;s name<span class="nt">&lt;/value&gt;</span>
     <span class="nt">&lt;/text&gt;</span>
   <span class="nt">&lt;/translation&gt;</span>
 <span class="nt">&lt;/itext&gt;</span>
 <span class="nt">&lt;instance&gt;</span>
   <span class="nt">&lt;sample</span> <span class="na">id=</span><span class="s">&quot;sample-v1.0&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;orx:meta&gt;</span>
        <span class="nt">&lt;orx:instanceID/&gt;</span>
     <span class="nt">&lt;/orx:meta&gt;</span>
     <span class="nt">&lt;name/&gt;</span>
   <span class="nt">&lt;/sample&gt;</span>
 <span class="nt">&lt;/instance&gt;</span>
 <span class="nt">&lt;submission</span> <span class="na">method=</span><span class="s">&quot;form-data-post&quot;</span>
             <span class="na">action=</span><span class="s">&quot;https://my-opendatakit.appspot.com/submission&quot;</span>
             <span class="na">base64RsaPublicKey=</span><span class="s">&quot;MIIBIjANB...JCwIDAQAB&quot;</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;bind</span> <span class="na">nodeset=</span><span class="s">&quot;/sample/meta/instanceID&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">readonly=</span><span class="s">&quot;true()&quot;</span>
       <span class="na">calculate=</span><span class="s">&quot;concat(&#39;uuid:&#39;, uuid())&quot;</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;bind</span> <span class="na">nodeset=</span><span class="s">&quot;/sample/name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/model&gt;</span>
 <span class="nt">&lt;/h:head&gt;</span>
 <span class="nt">&lt;h:body&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">ref=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">ref=</span><span class="s">&quot;jr:itext(&#39;ask_name&#39;)&quot;</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;/input&gt;</span>
 <span class="nt">&lt;/h:body&gt;</span>
 <span class="nt">&lt;/h:html&gt;</span>
</pre></div>
</div>
<p>If you are using <a class="reference internal" href="xlsform.html"><span class="doc">XLSForm</span></a>, then form encryption is governed by the <span class="guilabel">settings</span> on the <a class="reference external" href="http://xlsform.org/#settings_ws">Settings Worksheet</a>. Encrypted forms must specify a <em>submission_url</em> and a <em>public_key</em> on this worksheet. If both are specified, XLSForm will generate an encrypted-form definition. Skip to the following sections to see how to create a public-private key pair and specify the public key.</p>
<p>The required element to make this form an encrypted form is the <code class="docutils literal"><span class="pre">&lt;submission/&gt;</span></code> tag. Within this tag, the method attribute should always be <strong>form-data-post</strong>. The action attribute should be the url to which the submission should be posted; this is the ODK Aggregate website url with Aggregate.html replaced by submission. Finally, what identifies the form as an encrypted form is the presence of a <em>base64RsaPublicKey</em> attribute. This should be the base64 encoding of the RSA public key that ODK Collect uses to encrypt the symmetric encryption key it creates to encrypt a finalized instance of this form (a different symmetric encryption key is created for every finalized form)</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<ul class="last simple">
<li>The presence of the OpenRosa metadata block, as defined here: <a class="reference external" href="https://bitbucket.org/javarosa/javarosa/wiki/OpenRosaMetaDataSchema">OpenRosa 1.0 Metadata Schema</a>; is required.</li>
<li>You can define any value for the instanceID field, but it must be unique across all collected surveys.</li>
<li>As shown, the <code class="docutils literal"><span class="pre">&lt;bind/&gt;</span></code> calculates an instanceID value comparable to the instanceID value ODK Aggregate will generate when a form does not have an instanceID field.</li>
<li>If you use punctuation other than colon and dash, or any special characters, please test thoroughly to ensure that ODK Aggregate correctly handles those characters during submissions and when the form is pulled down to ODK Briefcase.</li>
</ul>
</div>
</div>
<div class="section" id="creating-rsa-key-pair">
<span id="create-rsa-key"></span><h2>Creating RSA Key pair<a class="headerlink" href="#creating-rsa-key-pair" title="Link zu dieser Überschrift">¶</a></h2>
<p>RSA public-private key pairs are generated using the OpenSSL software package. This is pre-installed on OSX and Linux but needs to be downloaded and installed on Windows.</p>
<div class="section" id="install-openssl-windows-only">
<span id="install-openssl"></span><h3>Install OpenSSL (Windows only)<a class="headerlink" href="#install-openssl-windows-only" title="Link zu dieser Überschrift">¶</a></h3>
<p>For Windows, download and run the OpenSSL installer appropriate for your system from OpenSSL for Windows. When it asks whether to copy the DLLs to the Windows system directory or to the <code class="file docutils literal"><span class="pre">/bin</span></code> directory, choose the <code class="file docutils literal"><span class="pre">/bin</span></code> directory (either will work, but this will minimize the pollution of the Windows system directory)</p>
</div>
<div class="section" id="constructing-the-rsa-key-pair">
<span id="construct-key"></span><h3>Constructing the RSA Key Pair<a class="headerlink" href="#constructing-the-rsa-key-pair" title="Link zu dieser Überschrift">¶</a></h3>
<p>If you are on Windows, open a PowerShell or command prompt window. Change directories to the <code class="file docutils literal"><span class="pre">/bin</span></code> directory in the OpenSSL directory. e.g.,</p>
<div class="highlight-doscon"><div class="highlight"><pre><span></span><span class="go">&gt; cd C:\OpenSSL-Win32\bin</span>
</pre></div>
</div>
<p>If you are on a Mac, open the terminal. Change directories to your Desktop.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> ~/Desktop
</pre></div>
</div>
</div>
<div class="section" id="create-a-private-key">
<span id="create-key"></span><h3>Create a private key<a class="headerlink" href="#create-a-private-key" title="Link zu dieser Überschrift">¶</a></h3>
<p>The following command will create a 2048-bit private key and write it to the <code class="file docutils literal"><span class="pre">MyPrivateKey.pem</span></code> file. This may complain about a missing configuration file. You can ignore this warning.</p>
<p>If you are on Windows, run:</p>
<div class="highlight-doscon"><div class="highlight"><pre><span></span><span class="go">&gt; openssl genpkey -out MyPrivateKey.pem -outform PEM -algorithm RSA -pkeyopt rsa_keygen_bits:2048</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warnung</p>
<p><strong>On Powershell</strong></p>
<blockquote>
<div>Check <strong>$env:path</strong> to be sure <code class="file docutils literal"><span class="pre">path\OpenSSL-Win64\bin</span></code> is in there.If it is not, run the following command in Powershell:</div></blockquote>
<div class="last highlight-console"><div class="highlight"><pre><span></span><span class="gp">&gt;</span> <span class="nv">$env</span>:path <span class="o">=</span> <span class="nv">$env</span>:path + <span class="s2">&quot;;path to OpenSSL-Win64\bin&quot;</span>
</pre></div>
</div>
</div>
<p>If you are on a Mac, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openssl genrsa -out MyPrivateKey.pem <span class="m">2048</span>
</pre></div>
</div>
</div>
<div class="section" id="extract-a-public-key">
<span id="extract-key"></span><h3>Extract a public key<a class="headerlink" href="#extract-a-public-key" title="Link zu dieser Überschrift">¶</a></h3>
<p>Next, you need to extract the public key for this private key.</p>
<p>Run the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">openssl rsa -in MyPrivateKey.pem -inform PEM -out MyPublicKey.pem -outform PEM -pubout</span>
</pre></div>
</div>
<p>This may also complain about a missing configuration file. You can ignore this warning.</p>
</div>
<div class="section" id="storing-and-using-the-keys">
<span id="store-use-keys"></span><h3>Storing and using the keys<a class="headerlink" href="#storing-and-using-the-keys" title="Link zu dieser Überschrift">¶</a></h3>
<p>Move the <code class="file docutils literal"><span class="pre">MyPrivateKey.pem</span></code> file to a secure location. It does not have a password encoding it, so anyone can decrypt your data if they have access to this file. This is the private key file that you will give to ODK Briefcase when decrypting the data.</p>
</div>
<div class="section" id="updating-the-public-key-field-in-the-xlsform-settings-worksheet">
<span id="update-keys"></span><h3>Updating the public_key field in the XLSForm settings worksheet.<a class="headerlink" href="#updating-the-public-key-field-in-the-xlsform-settings-worksheet" title="Link zu dieser Überschrift">¶</a></h3>
<p>Open the <code class="file docutils literal"><span class="pre">MyPublicKey.pem</span></code> file and copy the resulting very-long string inside <strong>—-BEGIN/END—-</strong> lines and paste it into the <strong>public_key field</strong> in the XLSForm settings worksheet. This very-long string will become the <em>base64RsaPublicKey</em> attribute in the resulting encrypted form definition.</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<ul class="last simple">
<li>You  need to be especially careful that this is ONLY the public key and not the contents of the original public-private key file (which would also appear to work but provide no security).</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tipp</p>
<ul class="last simple">
<li>You can use Notepad (Windows) or TextEdit (Mac) to open <code class="file docutils literal"><span class="pre">MyPublicKey.pem</span></code></li>
<li>Alternatively, you can use the command <code class="docutils literal"><span class="pre">less</span> <span class="pre">MyPublicKey.pem</span></code> to print the contents into the terminal and directly copy/paste from there.</li>
</ul>
</div>
<div class="admonition seealso">
<p class="first admonition-title">Siehe auch</p>
<ul class="last simple">
<li>For reference, you can checkout the <a class="reference external" href="https://docs.google.com/spreadsheets/d/1O2VW5dNxXeyr-V_GB3spS6QPX4rtqtt7ijqP_uZLU3I/edit#gid=390337726">tutorial encrypted-XLSForm</a>.It is for viewing purpose only but you can make your own copy to edit it.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="operations">
<span id="encrypt-operations"></span><h2>Operations<a class="headerlink" href="#operations" title="Link zu dieser Überschrift">¶</a></h2>
<p>Operationally, you would add the form definition to the ODK Aggregate server identified in the <code class="docutils literal"><span class="pre">&lt;submission&gt;</span></code> tag’s action attribute, and deploy everything using ODK Collect 1.2 RC1 or later, figure out how you want to implement a periodic SD Card wiping protocol for your devices, and you’re done. Submissions will be encrypted when marked as complete. Once the data is on ODK Aggregate, use ODK Briefcase to download the encrypted submissions to your PC, and then specify the private key PEM file when decrypting and generating the CSV files.</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<ul class="last simple">
<li>ODK Aggregate will only hold the encrypted submission with no access to the private key</li>
<li>ODK Briefcase will emit the CSV with an extra final column that indicates whether the signature of the encrypted file was good or bad.  It would be bad if any of the attachments are missing or if there was tampering (other than the wholesale replacement of a submission, which can’t be detected).</li>
</ul>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="briefcase-api.html" class="btn btn-neutral" title="Briefcase Aggregate API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Briefcase Aggregate API</a>
       
      
        <a href="security-privacy.html" class="btn btn-neutral float-right" title="Security and Privacy" accesskey="n" rel="next">Security and Privacy <span class="fa fa-arrow-circle-right"></span></a>
      
    </div>
  

  <hr/>
  <p class="footerText"> 

If you still need help, you can ask support questions in the

 <a href="

https://forum.opendatakit.org/

"> 

ODK Forum

 </a> </p>
  <p class="footerText"> 

If you find a problem with this documentation, please 

 <a href="

https://github.com/opendatakit/docs/issues

"> 

file an issue

 </a> </p>
  <p class="footerText"> 

You are also encouraged to

 <a href=" 

https://github.com/opendatakit/docs/

"> 

fork our Github repo 

 </a>  

and 

 <a href="

/contributing/

"> 

become a contributor

 </a></p>
  
  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Open Data Kit. This document is licensed under a Creative Commons Attribution 4.0 International License.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/js/custom.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>